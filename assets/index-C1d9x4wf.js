var m=n=>{throw TypeError(n)};var S=(n,e,t)=>e.has(n)||m("Cannot "+t);var f=(n,e,t)=>e.has(n)?m("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var y=(n,e,t)=>(S(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();class a{static get(e){return localStorage.getItem(e)}static set(e,t){localStorage.setItem(e,t)}static remove(e){localStorage.removeItem(e)}static clear(){localStorage.clear()}static keys(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);e.push(parseInt(s))}return e.sort((t,s)=>s-t),e}}var u,v;class O{constructor(e){f(this,u);this.storage=e,this.writer=document.getElementById("writer"),this.writer.smartMode="on";const t=[{key:"space",command:["insert","\\quad "]},{key:"enter",command:["addRowAfter"]}];this.writer.keybindings=[...this.writer.keybindings,...t]}set(e=Date.now()){this.number=e,y(this,u,v).call(this)}}u=new WeakSet,v=function(){this.writer.style.display="block",this.writer.addEventListener("input",()=>{this.storage.set(this.number,this.writer.value)});const e=this.storage.get(this.number);e!==null?this.writer.value=e:this.writer.value="\\displaylines{\\phantom{0}}"};class C{constructor(e=a){this.storage=e,this.pages=e.keys(),this.page=new O(e),this.count=this.pages.length}add(){return this.page.set(),this.page.number}open(e){this.page.set(e)}delete(e){this.storage.remove(e),this.page.writer.style.display="none"}list(){return this.pages}}/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=([n,e,t])=>{const s=document.createElementNS("http://www.w3.org/2000/svg",n);return Object.keys(e).forEach(o=>{s.setAttribute(o,String(e[o]))}),t!=null&&t.length&&t.forEach(o=>{const r=w(o);s.appendChild(r)}),s},l=(n,e={})=>{const t="svg",s={...M,...e};return w([t,s,n])};/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"}],["path",{d:"M8 11h8"}],["path",{d:"M8 7h6"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M3 15h6"}],["path",{d:"M6 12v6"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["path",{d:"M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v5"}],["circle",{cx:"13",cy:"12",r:"2"}],["path",{d:"M18 19c-2.8 0-5-2.2-5-5v8"}],["circle",{cx:"20",cy:"19",r:"2"}]],d=new C;let c=null;const k=document.getElementById("add-button"),h=document.getElementById("home-button"),g=document.getElementById("pages"),x=document.getElementById("src-code"),I=document.getElementById("frontpage"),A=document.getElementById("newpage-icon"),P=document.getElementById("frontpage-icon"),N=document.getElementById("json-input"),B=document.getElementById("import"),H=document.getElementById("export"),R=l(b),J=l(E),q=l(j),F=l(b),U=l(E);k.appendChild(R);h.appendChild(J);x.appendChild(q);A.appendChild(F);P.appendChild(U);const L=(n,e)=>{const t=document.createElement("button");return t.textContent=e,t.classList.add("page"),t.addEventListener("click",()=>{d.open(n),document.querySelectorAll(".active").forEach(s=>s.classList.remove("active")),t.classList.add("active"),I.style.display="none"}),t},D=(n,e)=>{const t=L(n,e);return g.appendChild(t),t},V=(n,e)=>{const t=L(n,e);return g.insertBefore(t,g.firstChild),t};let i=d.count;d.list().forEach(n=>{D(n,i),i--});i=d.count;k.addEventListener("click",()=>{i++;const n=d.add();V(n,i).click()});h.addEventListener("click",()=>{document.getElementById("writer").style.display="none",document.querySelectorAll(".active").forEach(n=>n.classList.remove("active")),I.style.display="block"});N.addEventListener("change",n=>{const e=n.target.files[0];if(!e){c=null;return}const t=new FileReader;t.onload=s=>{try{c=JSON.parse(s.target.result),B.removeAttribute("disabled")}catch{c=null,alert("Invalid JSON file.")}},t.readAsText(e)});B.addEventListener("click",()=>{if(c!==null){for(let[n,e]of Object.entries(c))a.get(n)!==null&&(n=Date.now()),a.set(n,e);location.reload()}});H.addEventListener("click",()=>{const n={};for(let r of a.keys())n[r]=a.get(r);const e=JSON.stringify(n,null,2),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),o=document.createElement("a");o.href=s,o.download=`mathbook-${Date.now()}.json`,o.click(),URL.revokeObjectURL(s)});h.click();

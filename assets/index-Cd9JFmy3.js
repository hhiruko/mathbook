var V=Object.defineProperty;var B=n=>{throw TypeError(n)};var H=(n,e,t)=>e in n?V(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var b=(n,e,t)=>H(n,typeof e!="symbol"?e+"":e,t),T=(n,e,t)=>e.has(n)||B("Cannot "+t);var f=(n,e,t)=>e.has(n)?B("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var l=(n,e,t)=>(T(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();var h,M;class J{constructor(e){f(this,h);this.storage=e,this.writer=document.getElementById("writer"),this.writer.smartMode="on";const t=[{key:"space",command:["insert","\\quad "]},{key:"enter",command:["addRowAfter"]}];this.writer.keybindings=[...this.writer.keybindings,...t]}set(e=Date.now()){this.number=e,l(this,h,M).call(this)}}h=new WeakSet,M=function(){this.writer.style.display="block",this.writer.addEventListener("input",()=>{this.storage.set(this.number,this.writer.value)});const e=this.storage.get(this.number);e!==null?this.writer.value=e:this.writer.value="\\displaylines{\\phantom{0}}"};class R{constructor(e){this.storage=e,this.pages=e.keys(),this.page=new J(e),this.count=this.pages.length}add(){return this.page.set(),this.page.number}open(e){this.page.set(e)}delete(e){this.storage.remove(e),this.page.writer.style.display="none"}list(){return this.pages}}class E{static get(e){return localStorage.getItem(e)}static set(e,t){localStorage.setItem(e,t)}static remove(e){localStorage.removeItem(e)}static clear(){localStorage.clear()}static keys(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);e.push(parseInt(s))}return e.sort((t,s)=>s-t),e}}var c,g,I;const r=class r{static get(e){var t;return l(t=r,c,g).call(t)[e]}static set(e,t){var o,a;const s=l(o=r,c,g).call(o);s[e]=t,l(a=r,c,I).call(a,s)}static remove(e){var s,o;const t=l(s=r,c,g).call(s);delete t[e],l(o=r,c,I).call(o,t)}static clear(){E.remove(r.COLLECTION_KEY)}static keys(){var s;const e=l(s=r,c,g).call(s),t=Object.keys(e).map(o=>parseInt(o));return t.sort((o,a)=>a-o),t}};c=new WeakSet,g=function(){return JSON.parse(E.get(r.COLLECTION_KEY)??"{}")},I=function(e){E.set(r.COLLECTION_KEY,JSON.stringify(e))},f(r,c),b(r,"COLLECTION_KEY","notebook-pages");let w=r;/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=([n,e,t])=>{const s=document.createElementNS("http://www.w3.org/2000/svg",n);return Object.keys(e).forEach(o=>{s.setAttribute(o,String(e[o]))}),t!=null&&t.length&&t.forEach(o=>{const a=O(o);s.appendChild(a)}),s},i=(n,e={})=>{const t="svg",s={...K,...e};return O([t,s,n])};/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"}],["path",{d:"M8 11h8"}],["path",{d:"M8 7h6"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z"}],["path",{d:"m7 16.5-4.74-2.85"}],["path",{d:"m7 16.5 5-3"}],["path",{d:"M7 16.5v5.17"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z"}],["path",{d:"m17 16.5-5-3"}],["path",{d:"m17 16.5 4.74-2.85"}],["path",{d:"M17 16.5v5.17"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z"}],["path",{d:"M12 8 7.26 5.15"}],["path",{d:"m12 8 4.74-2.85"}],["path",{d:"M12 13.5V8"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M3 15h6"}],["path",{d:"M6 12v6"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v5"}],["circle",{cx:"13",cy:"12",r:"2"}],["path",{d:"M18 19c-2.8 0-5-2.2-5-5v8"}],["circle",{cx:"20",cy:"19",r:"2"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17"}]];class Y{constructor(e){this.storage=e}import(e){let t=1;for(let[s,o]of Object.entries(e))this.storage.get(s)!==null&&(s=Date.now()+t,t++),this.storage.set(s,o)}export(){const e={};for(let d of this.storage.keys())e[d]=this.storage.get(d);const t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mathbook-${Date.now()}.json`,a.click(),URL.revokeObjectURL(o)}}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/mathbook/service-worker.js")});const y=w,P=new Y(y),p=new R(y);let u=null;const j=document.getElementById("add-button"),L=document.getElementById("home-button"),k=document.getElementById("pages"),W=document.getElementById("src-code"),D=document.getElementById("frontpage"),Z=document.getElementById("newpage-icon"),G=document.getElementById("frontpage-icon"),$=document.getElementById("json-input"),A=document.getElementById("import"),z=document.getElementById("export"),Q=document.getElementById("dependencies-icon"),X=document.getElementById("import-export-icon"),_=document.getElementById("delete-icon"),ee=document.getElementById("trigger-delete-dialog"),te=document.getElementById("delete-dialog"),ne=document.getElementById("delete"),v=document.getElementById("trigger-delete-page-dialog"),oe=document.getElementById("delete-page-dialog"),se=document.getElementById("delete-page"),ae=i(S),re=i(C),ce=i(U),ie=i(S),le=i(C),de=i(q),pe=i(F),ge=i(x),ue=i(x);j.appendChild(ae);L.appendChild(re);W.appendChild(ce);Z.appendChild(ie);G.appendChild(le);Q.appendChild(de);X.appendChild(pe);_.appendChild(ge);v.appendChild(ue);const N=(n,e)=>{const t=document.createElement("button");return t.textContent=e,t.classList.add("page"),t.addEventListener("click",()=>{p.open(n),document.querySelectorAll(".active").forEach(s=>s.classList.remove("active")),t.classList.add("active"),D.style.display="none",v.style.display="block"}),t},me=(n,e)=>{const t=N(n,e);return k.appendChild(t),t},he=(n,e)=>{const t=N(n,e);return k.insertBefore(t,k.firstChild),t};let m=p.count;p.list().forEach(n=>{me(n,m),m--});m=p.count;j.addEventListener("click",()=>{m++;const n=p.add();he(n,m).click()});L.addEventListener("click",()=>{document.getElementById("writer").style.display="none",document.querySelectorAll(".active").forEach(n=>n.classList.remove("active")),D.style.display="block",v.style.display="none"});$.addEventListener("change",n=>{const e=n.target.files[0];if(!e){u=null;return}const t=new FileReader;t.onload=s=>{try{u=JSON.parse(s.target.result),A.removeAttribute("disabled")}catch{u=null,alert("Invalid JSON file.")}},t.readAsText(e)});A.addEventListener("click",()=>{u!==null&&(P.import(u),location.reload())});z.addEventListener("click",()=>{P.export()});ee.addEventListener("click",()=>{te.showModal()});ne.addEventListener("click",n=>{n.preventDefault(),y.clear(),location.reload()});v.addEventListener("click",()=>{oe.showModal()});se.addEventListener("click",n=>{n.preventDefault(),y.remove(p.page.number),location.reload()});L.click();

var q=Object.defineProperty;var A=n=>{throw TypeError(n)};var F=(n,e,t)=>e in n?q(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var g=(n,e,t)=>F(n,typeof e!="symbol"?e+"":e,t),U=(n,e,t)=>e.has(n)||A("Cannot "+t);var f=(n,e,t)=>e.has(n)?A("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var c=(n,e,t)=>(U(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();var k,H;class Z{constructor(e){f(this,k);this.storage=e,this.writer=document.getElementById("writer"),this.writer.smartMode="on";const t=[{key:"space",command:["insert","\\quad "]},{key:"enter",command:["addRowAfter"]}];this.writer.keybindings=[...this.writer.keybindings,...t]}set(e=Date.now()){this.number=e,c(this,k,H).call(this)}}k=new WeakSet,H=function(){this.writer.style.display="block",this.writer.addEventListener("input",()=>{this.storage.set(this.number,this.writer.value)});const e=this.storage.get(this.number);e!==null?this.writer.value=e:this.writer.value="\\displaylines{\\phantom{0}}"};class W{constructor(e){this.storage=e,this.pages=e.keys(),this.page=new Z(e),this.count=this.pages.length}add(){return this.page.set(),this.page.number}open(e){this.page.set(e)}delete(e){this.storage.remove(e),this.page.writer.style.display="none"}list(){return this.pages}}class v{static get(e){return localStorage.getItem(e)}static set(e,t){localStorage.setItem(e,t)}static remove(e){localStorage.removeItem(e)}static clear(){localStorage.clear()}static keys(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);e.push(parseInt(s))}return e.sort((t,s)=>s-t),e}}var p,u,B;const i=class i{static get(e){var t;return c(t=i,p,u).call(t)[e]}static set(e,t){var o,a;const s=c(o=i,p,u).call(o);s[e]=t,c(a=i,p,B).call(a,s)}static remove(e){var s,o;const t=c(s=i,p,u).call(s);delete t[e],c(o=i,p,B).call(o,t)}static clear(){v.remove(i.COLLECTION_KEY)}static keys(){var s;const e=c(s=i,p,u).call(s),t=Object.keys(e).map(o=>parseInt(o));return t.sort((o,a)=>a-o),t}};p=new WeakSet,u=function(){return JSON.parse(v.get(i.COLLECTION_KEY)??"{}")},B=function(e){v.set(i.COLLECTION_KEY,JSON.stringify(e))},f(i,p),g(i,"COLLECTION_KEY","notebook-pages");let L=i;/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=([n,e,t])=>{const s=document.createElementNS("http://www.w3.org/2000/svg",n);return Object.keys(e).forEach(o=>{s.setAttribute(o,String(e[o]))}),t!=null&&t.length&&t.forEach(o=>{const a=D(o);s.appendChild(a)}),s},l=(n,e={})=>{const t="svg",s={...$,...e};return D([t,s,n])};/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"}],["path",{d:"M8 11h8"}],["path",{d:"M8 7h6"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z"}],["path",{d:"m7 16.5-4.74-2.85"}],["path",{d:"m7 16.5 5-3"}],["path",{d:"M7 16.5v5.17"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z"}],["path",{d:"m17 16.5-5-3"}],["path",{d:"m17 16.5 4.74-2.85"}],["path",{d:"M17 16.5v5.17"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z"}],["path",{d:"M12 8 7.26 5.15"}],["path",{d:"m12 8 4.74-2.85"}],["path",{d:"M12 13.5V8"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M3 15h6"}],["path",{d:"M6 12v6"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v5"}],["circle",{cx:"13",cy:"12",r:"2"}],["path",{d:"M18 19c-2.8 0-5-2.2-5-5v8"}],["circle",{cx:"20",cy:"19",r:"2"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M12 8a2.83 2.83 0 0 0 4 4 4 4 0 1 1-4-4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.9 4.9 1.4 1.4"}],["path",{d:"m17.7 17.7 1.4 1.4"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.3 17.7-1.4 1.4"}],["path",{d:"m19.1 4.9-1.4 1.4"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["circle",{cx:"12",cy:"12",r:"4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.93 4.93 1.41 1.41"}],["path",{d:"m17.66 17.66 1.41 1.41"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.34 17.66-1.41 1.41"}],["path",{d:"m19.07 4.93-1.41 1.41"}]];/**
 * @license lucide v0.517.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17"}]];class ne{constructor(e){this.storage=e}import(e){let t=1;for(let[s,o]of Object.entries(e))this.storage.get(s)!==null&&(s=Date.now()+t,t++),this.storage.set(s,o)}export(){const e={};for(let h of this.storage.keys())e[h]=this.storage.get(h);const t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mathbook-${Date.now()}.json`,a.click(),URL.revokeObjectURL(o)}}var d,I,Y,C;const r=class r{constructor(e){f(this,d);this.storage=e,c(this,d,C).call(this,c(this,d,I).call(this))}toggle(){const e=[r.SYSTEM,r.DARK,r.LIGHT];let t=e.findIndex(o=>o===c(this,d,I).call(this));t===2?t=0:t++;const s=e[t];c(this,d,C).call(this,s),c(this,d,Y).call(this,s)}getIcon(){let e=null;switch(c(this,d,I).call(this)){case r.LIGHT:e=te;break;case r.DARK:e=_;break;case r.SYSTEM:default:e=ee}return e}};d=new WeakSet,I=function(){return this.storage.get(r.THEME_KEY)??r.SYSTEM},Y=function(e){this.storage.set(r.THEME_KEY,e)},C=function(e){const t=document.getElementById(r.THEME_KEY);switch(e){case r.LIGHT:t.setAttribute("href","/mathbook/cdn/water.light.min.css");break;case r.DARK:t.setAttribute("href","/mathbook/cdn/water.dark.min.css");break;case r.SYSTEM:default:t.setAttribute("href","/mathbook/cdn/water.system.min.css")}},g(r,"THEME_KEY","theme-preference"),g(r,"SYSTEM","system"),g(r,"LIGHT","light"),g(r,"DARK","dark");let S=r;"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/mathbook/service-worker.js")});const oe=v,O=new S(oe),M=L,N=new ne(M),m=new W(M);let y=null;const R=document.getElementById("add-button"),T=document.getElementById("home-button"),x=document.getElementById("pages"),se=document.getElementById("src-code"),V=document.getElementById("frontpage"),ae=document.getElementById("newpage-icon"),re=document.getElementById("frontpage-icon"),ce=document.getElementById("json-input"),G=document.getElementById("import"),ie=document.getElementById("export"),de=document.getElementById("dependencies-icon"),le=document.getElementById("import-export-icon"),pe=document.getElementById("delete-icon"),he=document.getElementById("trigger-delete-dialog"),ge=document.getElementById("delete-dialog"),me=document.getElementById("delete"),b=document.getElementById("trigger-delete-page-dialog"),ue=document.getElementById("delete-page-dialog"),ye=document.getElementById("delete-page"),w=document.getElementById("theme-button"),Ee=l(j),fe=l(P),ve=l(X),Ie=l(j),we=l(P),ke=l(z),Me=l(Q),be=l(K),Le=l(K);R.appendChild(Ee);T.appendChild(fe);se.appendChild(ve);ae.appendChild(Ie);re.appendChild(we);de.appendChild(ke);le.appendChild(Me);pe.appendChild(be);b.appendChild(Le);w.appendChild(l(O.getIcon()));const J=(n,e)=>{const t=document.createElement("button");return t.textContent=e,t.classList.add("page"),t.addEventListener("click",()=>{m.open(n),document.querySelectorAll(".active").forEach(s=>s.classList.remove("active")),t.classList.add("active"),V.style.display="none",b.style.display="block"}),t},Be=(n,e)=>{const t=J(n,e);return x.appendChild(t),t},Se=(n,e)=>{const t=J(n,e);return x.insertBefore(t,x.firstChild),t};let E=m.count;m.list().forEach(n=>{Be(n,E),E--});E=m.count;R.addEventListener("click",()=>{E++;const n=m.add();Se(n,E).click()});T.addEventListener("click",()=>{document.getElementById("writer").style.display="none",document.querySelectorAll(".active").forEach(n=>n.classList.remove("active")),V.style.display="block",b.style.display="none"});ce.addEventListener("change",n=>{const e=n.target.files[0];if(!e){y=null;return}const t=new FileReader;t.onload=s=>{try{y=JSON.parse(s.target.result),G.removeAttribute("disabled")}catch{y=null,alert("Invalid JSON file.")}},t.readAsText(e)});G.addEventListener("click",()=>{y!==null&&(N.import(y),location.reload())});ie.addEventListener("click",()=>{N.export()});he.addEventListener("click",()=>{ge.showModal()});me.addEventListener("click",n=>{n.preventDefault(),M.clear(),location.reload()});b.addEventListener("click",()=>{ue.showModal()});ye.addEventListener("click",n=>{n.preventDefault(),M.remove(m.page.number),location.reload()});w.addEventListener("click",()=>{O.toggle(),w.innerHTML="",w.appendChild(l(O.getIcon()))});T.click();
